#
# メインコンテナ
#
main:
  build: .

  volumes:
   - .:/products

  command: ruby run.rb

  ports:
    - "3000:3000"

  volumes:
    - ".:/products"

  links:
    - "mysql:mysql"
    - "redis:redis"

  command: rails s -b 0.0.0.0

#
# MySQLのコンテナ
#
# コンテナへのアクセスは
# $> docker exec -i -t [コンテナID] /bin/bash
#
# MySQLへのアクセスは
# $> mysql -uroot -p -hmysql
#
# macからは
# $> mysql -uroot -p -hlocal-vm(hostsにlocal-vmを設定した場合)
#
mysql:
  image: mysql:5.5

  environment:
    - MYSQL_ROOT_PASSWORD=root

  ports:
    - "3306:3306"

redis:
  image: redis:latest

  ports:
    - "6380:6380"
